(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{291:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Y});var r=s(6027),a=s(7307);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),d=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),n=e=>{let t=d(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:n="",children:o,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...c,width:r,height:r,stroke:s,strokeWidth:d?24*Number(l)/Number(r):l,className:i("lucide",n),...m},[...u.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(o)?o:[o]])}),u=(e,t)=>{let s=(0,a.forwardRef)((s,r)=>{let{className:d,...c}=s;return(0,a.createElement)(o,{ref:r,iconNode:t,className:i("lucide-".concat(l(n(e))),"lucide-".concat(e),d),...c})});return s.displayName=n(e),s},m=u("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),x=u("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),h=u("download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),p=u("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function g(e){let{products:t,records:s,importData:l}=e,[d,n]=(0,a.useState)(null),[i,c]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"mb-4 rounded bg-white p-4 shadow",children:[(0,r.jsxs)("div",{className:"flex cursor-pointer items-center justify-between",onClick:()=>{c(!i),i||n(null)},children:[(0,r.jsx)("h2",{className:"font-medium text-lg",children:"数据同步"}),i?(0,r.jsx)(m,{className:"h-5 w-5 text-gray-500"}):(0,r.jsx)(x,{className:"h-5 w-5 text-gray-500"})]}),i&&(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify({products:t,records:s},null,2)],{type:"application/json"}),r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download="理财产品信息-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)},className:"flex items-center rounded bg-blue-500 px-3 py-2 text-white transition-colors hover:bg-blue-600",children:[(0,r.jsx)(h,{className:"mr-1 h-4 w-4"}),(0,r.jsx)("span",{children:"导出数据"})]}),(0,r.jsxs)("label",{className:"flex cursor-pointer items-center rounded bg-green-500 px-3 py-2 text-white transition-colors hover:bg-green-600",children:[(0,r.jsx)(p,{className:"mr-1 h-4 w-4"}),(0,r.jsx)("span",{children:"导入数据"}),(0,r.jsx)("input",{type:"file",accept:".json",onChange:e=>{var t;n(null);let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!s)return;let r=new FileReader;r.onload=e=>{try{var t;let s=null===(t=e.target)||void 0===t?void 0:t.result,r=JSON.parse(s);if(!r.products||!Array.isArray(r.products)||!r.records||!Array.isArray(r.records))throw Error("导入的文件格式不正确");l(r)}catch(e){n(e instanceof Error?e.message:"导入失败")}},r.readAsText(s),e.target.value=""},className:"hidden"})]})]}),d&&(0,r.jsx)("p",{className:"mt-2 text-red-500 text-sm",children:d})]})]})}let b=u("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),v=u("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),j=[{value:"",label:"选择风险等级"},{value:"R1",label:"R1 - 低风险"},{value:"R2",label:"R2 - 中低风险"},{value:"R3",label:"R3 - 中风险"},{value:"R4",label:"R4 - 中高风险"},{value:"R5",label:"R5 - 高风险"}],N=()=>{let e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(r)},y=(e,t)=>{let s=new Date(e);return Math.floor(((t?new Date(t):new Date).getTime()-s.getTime())/864e5)},f=e=>{if(!e)return 0;let t=e.redeemed&&e.redemptionDate?e.redemptionDate:N();return y(e.purchaseDate,t)},w=e=>{var t,s,l,d;let{product:n,updateProduct:i,deleteProduct:c,toggleRedeemStatus:o,onDeleteComplete:u}=e,[h,p]=(0,a.useState)(!1),[g,N]=(0,a.useState)(!1),[y,w]=(0,a.useState)(!1),[k,S]=(0,a.useState)(!1),[A,C]=(0,a.useState)(n.name),[P,D]=(0,a.useState)((null===(t=n.monthlyYieldAtPurchase)||void 0===t?void 0:t.toString())||""),[Y,R]=(0,a.useState)((null===(s=n.inceptionYieldAtPurchase)||void 0===s?void 0:s.toString())||""),[F,L]=(0,a.useState)(n.riskLevel||""),[q,O]=(0,a.useState)(n.notes||""),z=[{label:"产品代码",value:n.productCode||(0,r.jsx)("span",{className:"text-gray-400",children:"暂无"})},{label:"购买日期",value:n.purchaseDate},{label:"持仓成本价",value:n.purchaseNetValue},{label:"持仓成本",value:n.purchaseAmount?"\xa5".concat(n.purchaseAmount.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})):(0,r.jsx)("span",{className:"text-gray-400",children:"暂无"})},{label:"持仓份额",value:"".concat(n.shares.toFixed(2)," 份")},{label:"持有天数",value:f(n)},{label:"赎回状态",value:n.redeemed?"已赎回":"未赎回"}];return n.redeemed&&n.redemptionDate&&z.push({label:"赎回日期",value:n.redemptionDate}),(0,r.jsxs)("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex cursor-pointer items-center justify-between",onClick:()=>{p(!h)},children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("h2",{className:"font-semibold text-lg",children:"产品详情"}),(0,r.jsx)("span",{className:"ml-3 text-sm ".concat(n.redeemed?"text-gray-500":"text-green-600"),children:n.redeemed?"已赎回":"持有中"})]}),h?(0,r.jsx)(m,{className:"h-5 w-5 text-gray-500"}):(0,r.jsx)(x,{className:"h-5 w-5 text-gray-500"})]}),h&&(0,r.jsxs)("div",{className:"mt-4 space-y-3 text-sm",children:[(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,r.jsx)("div",{className:"col-span-1 font-medium",children:"产品名称:"}),g?(0,r.jsxs)("div",{className:"col-span-2 flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"text",value:A,onChange:e=>C(e.target.value),className:"rounded-md border p-2"}),(0,r.jsx)("button",{onClick:()=>{if(""===A.trim()){alert("产品名称不能为空");return}i(n.id,{name:A}),N(!1),C("")},className:"rounded-md bg-blue-500 px-3 py-1 text-white hover:bg-blue-600",children:"保存"}),(0,r.jsx)("button",{onClick:()=>N(!1),className:"rounded-md bg-gray-300 px-3 py-1 text-gray-700 hover:bg-gray-400",children:"取消"})]}):(0,r.jsxs)("div",{className:"col-span-2 flex items-center space-x-2",children:[(0,r.jsx)("span",{children:n.name}),(0,r.jsx)("button",{onClick:()=>{N(!0),C(n.name)},className:"ml-2 text-blue-500 hover:text-blue-700",children:(0,r.jsx)(b,{className:"h-4 w-4"})})]}),z.map((e,t)=>(0,r.jsxs)(a.Fragment,{children:[(0,r.jsxs)("div",{className:"col-span-1 font-medium",children:[e.label,":"]}),(0,r.jsx)("div",{className:"col-span-2",children:e.value})]},t))]})}),!y&&(0,r.jsx)("div",{className:"mt-4 rounded-md bg-gray-100 p-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"决策辅助信息:"}),void 0!==n.monthlyYieldAtPurchase?(0,r.jsxs)(r.Fragment,{children:["购买时近1月年化 ",n.monthlyYieldAtPurchase,"% | 成立以来年化"," ",null!==(l=n.inceptionYieldAtPurchase)&&void 0!==l?l:"未记录","% | 风险等级 ",null!==(d=n.riskLevel)&&void 0!==d?d:"未设置"]}):(0,r.jsx)(r.Fragment,{children:"暂无"})]}),(0,r.jsx)("button",{onClick:()=>{var e,t;D((null===(e=n.monthlyYieldAtPurchase)||void 0===e?void 0:e.toString())||""),R((null===(t=n.inceptionYieldAtPurchase)||void 0===t?void 0:t.toString())||""),L(n.riskLevel||""),w(!0)},className:"text-blue-500 hover:text-blue-700",children:void 0!==n.monthlyYieldAtPurchase?(0,r.jsx)(b,{className:"h-4 w-4"}):(0,r.jsx)(v,{className:"h-4 w-4"})})]})}),y&&(0,r.jsxs)("div",{className:"mt-3 rounded-md border border-gray-200 p-3",children:[(0,r.jsxs)("h3",{className:"mb-2 font-medium text-sm",children:[void 0!==n.monthlyYieldAtPurchase?"编辑":"添加","决策辅助信息"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1 block text-gray-600 text-sm",children:"购买时近1月年化(%)"}),(0,r.jsx)("input",{type:"number",step:"0.01",value:P,onChange:e=>D(e.target.value),className:"w-full rounded-md border p-2"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1 block text-gray-600 text-sm",children:"购买时成立以来年化(%)"}),(0,r.jsx)("input",{type:"number",step:"0.01",value:Y,onChange:e=>R(e.target.value),className:"w-full rounded-md border p-2"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1 block text-gray-600 text-sm",children:"风险等级"}),(0,r.jsx)("select",{value:F,onChange:e=>L(e.target.value),className:"w-full rounded-md border p-2",children:j.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{if(P&&Number.isNaN(Number.parseFloat(P))){alert("近1月年化必须是有效数字");return}i(n.id,{monthlyYieldAtPurchase:P?Number.parseFloat(P):void 0,inceptionYieldAtPurchase:Y?Number.parseFloat(Y):void 0,riskLevel:F||void 0}),w(!1)},className:"rounded-md bg-blue-500 px-3 py-1 text-sm text-white hover:bg-blue-600",children:"保存"}),(0,r.jsx)("button",{onClick:()=>w(!1),className:"rounded-md bg-gray-300 px-3 py-1 text-gray-700 text-sm hover:bg-gray-400",children:"取消"})]})]})]}),(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"font-medium",children:"备注:"}),!k&&(0,r.jsx)("button",{onClick:()=>{O(n.notes||""),S(!0)},className:"text-blue-500 hover:text-blue-700",children:n.notes?(0,r.jsx)(b,{className:"h-4 w-4"}):(0,r.jsx)(v,{className:"h-4 w-4"})})]}),k?(0,r.jsxs)("div",{className:"mt-1",children:[(0,r.jsx)("textarea",{value:q,onChange:e=>O(e.target.value),className:"w-full rounded-md border p-2",rows:3}),(0,r.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{i(n.id,{notes:q||void 0}),S(!1)},className:"rounded-md bg-blue-500 px-3 py-1 text-sm text-white hover:bg-blue-600",children:"保存备注"}),(0,r.jsx)("button",{onClick:()=>S(!1),className:"rounded-md bg-gray-300 px-3 py-1 text-gray-700 text-sm hover:bg-gray-400",children:"取消"})]})]}):(0,r.jsx)("div",{className:"mt-1 rounded bg-gray-50 p-2",children:n.notes||(0,r.jsx)("span",{className:"text-gray-400",children:"暂无备注"})})]}),(0,r.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{n.redeemed?window.confirm("确定要取消该产品的赎回状态吗？")&&o(n.id):window.confirm("确定要标记该产品为已全部赎回吗？")&&o(n.id)},className:"".concat(n.redeemed?"bg-yellow-500 hover:bg-yellow-600":"bg-green-500 hover:bg-green-600"," rounded-md px-3 py-1 text-white"),children:n.redeemed?"取消赎回状态":"标记为已赎回"}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),window.confirm("确定要删除此产品及其所有记录吗？")&&(c(n.id),u())},className:"rounded-md bg-red-500 px-4 py-2 text-white hover:bg-red-600",children:"删除产品"})]})]})]})},k=e=>{let{onSubmit:t,onCancel:s}=e;return(0,r.jsxs)("div",{className:"rounded-lg bg-white p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"font-semibold text-xl",children:"新增理财产品"}),(0,r.jsx)("button",{onClick:s,className:"rounded-full bg-gray-200 px-3 py-1 text-sm transition hover:bg-gray-300",children:"取消"})]}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=new FormData(e.currentTarget),r={name:s.get("productName"),productCode:s.get("productCode"),purchaseDate:s.get("purchaseDate"),purchaseNetValue:Number.parseFloat(s.get("purchaseNetValue")),purchaseAmount:Number.parseFloat(s.get("purchaseAmount")),redeemed:!1,monthlyYieldAtPurchase:s.get("monthlyYieldAtPurchase")?Number.parseFloat(s.get("monthlyYieldAtPurchase")):void 0,inceptionYieldAtPurchase:s.get("inceptionYieldAtPurchase")?Number.parseFloat(s.get("inceptionYieldAtPurchase")):void 0,riskLevel:s.get("riskLevel"),notes:s.get("productNotes")||void 0,shares:0};r.shares=r.purchaseAmount/r.purchaseNetValue,t(r),e.currentTarget.reset()},className:"space-y-3",children:[(0,r.jsx)("input",{type:"text",name:"productName",placeholder:"产品名称",required:!0,className:"w-full rounded-md border p-2"}),(0,r.jsx)("input",{type:"text",name:"productCode",placeholder:"产品代码",className:"w-full rounded-md border p-2"}),(0,r.jsx)("input",{type:"date",name:"purchaseDate",required:!0,className:"w-full rounded-md border p-2"}),(0,r.jsx)("input",{type:"number",step:"0.00001",name:"purchaseNetValue",placeholder:"购买净值",required:!0,className:"w-full rounded-md border p-2"}),(0,r.jsx)("input",{type:"number",step:"0.01",name:"purchaseAmount",placeholder:"购买金额",className:"w-full rounded-md border p-2"}),(0,r.jsx)("input",{type:"number",step:"0.01",name:"monthlyYieldAtPurchase",placeholder:"购买时近1月年化(%)",className:"w-full rounded-md border p-2"}),(0,r.jsx)("input",{type:"number",step:"0.01",name:"inceptionYieldAtPurchase",placeholder:"购买时成立以来年化(%)",className:"w-full rounded-md border p-2"}),(0,r.jsx)("select",{name:"riskLevel",className:"w-full rounded-md border p-2",children:j.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,r.jsx)("textarea",{name:"productNotes",placeholder:"产品备注",className:"w-full rounded-md border p-2",rows:3}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded-md bg-blue-500 p-2 text-white hover:bg-blue-600",children:"保存产品"})]})]})},S=e=>{let{products:t,showRedeemed:s,setShowRedeemed:a,selectedProduct:l,setSelectedProduct:d,setShowAddProductForm:n,getLatestRecord:i}=e,c=[...s?t:t.filter(e=>!e.redeemed)].sort((e,t)=>{let s=i(e.id),r=i(t.id);return s?r?s.annualizedYield-r.annualizedYield:-1:1});return(0,r.jsxs)("div",{className:"rounded-lg bg-white p-4 shadow-sm sm:p-6",children:[(0,r.jsxs)("div",{className:"mb-4 flex flex-col items-start justify-between gap-2 sm:flex-row sm:items-center sm:gap-0",children:[(0,r.jsx)("h2",{className:"font-semibold text-lg sm:text-xl",children:"理财产品看板"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsx)("button",{onClick:()=>a(!s),className:"rounded-full bg-gray-200 px-2 py-1 text-xs transition hover:bg-gray-300 sm:px-3 sm:text-sm",children:s?"隐藏已赎回":"显示已赎回"}),(0,r.jsx)("button",{onClick:()=>n(!0),className:"rounded-full bg-blue-500 px-2 py-1 text-white text-xs transition hover:bg-blue-600 sm:px-3 sm:text-sm",children:"新增产品"})]})]}),0===c.length?(0,r.jsx)("p",{className:"py-4 text-center text-gray-500",children:0===t.length?"暂无理财产品":"没有未赎回的产品"}):(0,r.jsx)("div",{className:"space-y-3",children:c.map(e=>{let t=i(e.id);return(0,r.jsxs)("div",{className:"cursor-pointer rounded-md border p-3 sm:p-4 ".concat(l===e.id?"border-blue-500 bg-blue-50":e.redeemed?"border-gray-200 bg-gray-100":"border-gray-200 bg-gray-50"," transition hover:bg-gray-100"),onClick:()=>d(e.id),children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{className:"font-medium",children:e.name}),e.redeemed&&(0,r.jsx)("span",{className:"w-fit rounded-full bg-gray-200 px-2 py-0.5 text-gray-700 text-xs",children:"已赎回"})]}),(0,r.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-gray-500 text-xs",children:e.productCode}),(0,r.jsx)("span",{className:"text-xs ".concat(t?t.annualizedYield>=0?"text-green-600":"text-red-600":"text-gray-500"),children:t?"".concat(t.annualizedYield,"%"):"未查询"})]})]}),(0,r.jsxs)("div",{className:"mt-2 flex flex-row justify-between text-gray-600 text-xs sm:text-sm",children:[(0,r.jsxs)("span",{children:["购买净值: ",e.purchaseNetValue]}),(0,r.jsxs)("span",{children:["持有天数: ",f(e),"天"]})]}),t&&(0,r.jsxs)("div",{className:"mt-1 flex flex-row justify-between text-gray-600 text-xs sm:text-sm",children:[(0,r.jsxs)("span",{children:["持仓金额: ",t.currentAmount.toFixed(2),"元"]}),(0,r.jsxs)("span",{children:["日均收益:"," ",((t.currentAmount-e.purchaseAmount)/f(e)).toFixed(2),"元"]})]})]},e.id)})})]})},A=e=>{let{productId:t,onSubmit:s}=e,a=()=>{let e=localStorage.getItem("financialProducts");return e?JSON.parse(e).find(e=>e.id===t):null};return(0,r.jsxs)("div",{className:"rounded-lg bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 font-semibold text-xl",children:"收益查询"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let r=a();if(!r){alert("无法找到产品信息");return}let l=new FormData(e.currentTarget),d=l.get("queryDate"),n=Number.parseFloat(l.get("currentNetValue"));s(t,r.purchaseDate,d,n,r.purchaseNetValue,r.shares),e.currentTarget.reset()},className:"space-y-3",children:[(0,r.jsx)("input",{type:"date",name:"queryDate",defaultValue:N(),required:!0,className:"w-full rounded-md border p-2"}),(0,r.jsx)("input",{type:"number",step:"0.00001",name:"currentNetValue",placeholder:"当前净值",required:!0,className:"w-full rounded-md border p-2"}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded-md bg-green-500 p-2 text-white hover:bg-green-600",children:"计算年化收益率"})]})]})},C=e=>{let{product:t,records:s,latestRecord:a}=e,l=(()=>{if(!t.monthlyYieldAtPurchase||!a)return null;let e=a.annualizedYield-t.monthlyYieldAtPurchase;return{value:e.toFixed(2),isPositive:e>=0}})();return(0,r.jsxs)("div",{className:"rounded-lg bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 font-semibold text-xl",children:"查询历史"}),void 0!==t.monthlyYieldAtPurchase&&s.length>0&&(0,r.jsxs)("div",{className:"mb-4 rounded-md bg-gray-50 p-3",children:[(0,r.jsx)("h3",{className:"mb-1 font-semibold text-sm",children:"业绩对比"}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"购买时近1月年化:"}),(0,r.jsxs)("span",{className:t.monthlyYieldAtPurchase>=0?"text-green-600":"text-red-600",children:[t.monthlyYieldAtPurchase,"%"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"最新查询年化:"}),(0,r.jsxs)("span",{className:((null==a?void 0:a.annualizedYield)||0)>=0?"text-green-600":"text-red-600",children:[(null==a?void 0:a.annualizedYield)||0,"%"]})]}),l&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"业绩差异:"}),(0,r.jsxs)("span",{className:l.isPositive?"text-green-600":"text-red-600",children:[l.value,"%"]})]})]})]}),(0,r.jsx)("div",{className:"space-y-3",children:0===s.length?(0,r.jsx)("p",{className:"py-4 text-center text-gray-500",children:"暂无查询记录"}):s.map(e=>(0,r.jsxs)("div",{className:"rounded-md bg-gray-50 p-4",children:[(0,r.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,r.jsx)("span",{className:"font-medium",children:e.queryDate}),(0,r.jsxs)("span",{className:e.annualizedYield>=0?"text-green-600":"text-red-600",children:[e.annualizedYield,"%"]})]}),(0,r.jsxs)("div",{className:"text-gray-600 text-sm",children:["净值: ",e.currentNetValue," • 持有天数: ",e.daysHeld,"天"]}),e.currentAmount&&(0,r.jsxs)("div",{className:"mt-1 text-gray-600 text-sm",children:[(0,r.jsxs)("div",{children:["持仓金额: ",e.currentAmount.toFixed(2),"元 (成本: ",t.purchaseAmount,"元)"]}),e.daysHeld>0&&(0,r.jsxs)("div",{children:["平均每天收益: ",((e.currentAmount-t.purchaseAmount)/e.daysHeld).toFixed(2),"元"]})]})]},e.id))})]})},P=()=>{let[e,t]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=localStorage.getItem("financialProducts");e&&t(JSON.parse(e))},[]);let s=e=>(localStorage.setItem("financialProducts",JSON.stringify(e)),e),r=(r,a)=>{t(s(e.map(e=>e.id===r?{...e,...a}:e)))};return{products:e,addProduct:r=>{let a={id:crypto.randomUUID(),...r,redeemed:!1};return t(s([...e,a])),a},updateProduct:r,deleteProduct:r=>{let a=e.filter(e=>e.id!==r);return t(s(a)),a},toggleRedeemStatus:t=>{let s=e.find(e=>e.id===t);if(!s)return;let a=!s.redeemed;r(t,{redeemed:a,redemptionDate:a?N():void 0})},importProducts:e=>{t(e),localStorage.setItem("financialProducts",JSON.stringify(e))}}},D=()=>{let[e,t]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=localStorage.getItem("queryRecords");e&&t(JSON.parse(e))},[]);let s=e=>(localStorage.setItem("queryRecords",JSON.stringify(e)),e),r=t=>e.filter(e=>e.productId===t);return{records:e,addRecord:(r,a,l,d,n,i)=>{let c=y(a,l),o=Number(((d-n)/n*(365/Math.max(c,1))*100).toFixed(2)),u={id:crypto.randomUUID(),productId:r,queryDate:l,currentNetValue:d,annualizedYield:o,daysHeld:c,currentAmount:d*i};return t(s([...e,u])),u},getProductRecords:r,getLatestRecord:e=>{let t=r(e);return 0===t.length?null:t.reduce((e,t)=>new Date(t.queryDate)>new Date(e.queryDate)?t:e,t[0])},deleteProductRecords:r=>{t(s(e.filter(e=>e.productId!==r)))},importRecords:e=>{t(e),localStorage.setItem("queryRecords",JSON.stringify(e))}}};function Y(){let{products:e,addProduct:t,updateProduct:s,deleteProduct:l,toggleRedeemStatus:d,importProducts:n}=P(),{records:i,addRecord:c,getProductRecords:o,getLatestRecord:u,importRecords:m}=D(),[x,h]=(0,a.useState)(""),[p,b]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),N=e.find(e=>e.id===x);return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:(0,r.jsxs)("div",{className:"mx-auto max-w-2xl space-y-6",children:[(0,r.jsx)(g,{products:e,records:i,importData:e=>{n(e.products),m(e.records),h("")}}),(0,r.jsx)(S,{products:e,records:i,showRedeemed:p,setShowRedeemed:b,selectedProduct:x,setSelectedProduct:h,setShowAddProductForm:j,getLatestRecord:u}),v&&(0,r.jsx)(k,{onSubmit:t,onCancel:()=>j(!1)}),x&&N&&(0,r.jsx)(w,{product:N,updateProduct:s,deleteProduct:l,toggleRedeemStatus:d,onDeleteComplete:()=>h("")}),x&&(0,r.jsx)(A,{productId:x,onSubmit:c}),x&&N&&(0,r.jsx)(C,{product:N,records:o(x),latestRecord:u(x)})]})})}},7308:(e,t,s)=>{Promise.resolve().then(s.bind(s,291))}},e=>{var t=t=>e(e.s=t);e.O(0,[545,80,358],()=>t(7308)),_N_E=e.O()}]);